Downloading https://thor.robots.ox.ac.uk/datasets/pets/images.tar.gz to ../../../../../../work3/s226536/datasets/oxford-iiit-pet/images.tar.gz
Extracting ../../../../../../work3/s226536/datasets/oxford-iiit-pet/images.tar.gz to ../../../../../../work3/s226536/datasets/oxford-iiit-pet
Downloading https://thor.robots.ox.ac.uk/datasets/pets/annotations.tar.gz to ../../../../../../work3/s226536/datasets/oxford-iiit-pet/annotations.tar.gz
Extracting ../../../../../../work3/s226536/datasets/oxford-iiit-pet/annotations.tar.gz to ../../../../../../work3/s226536/datasets/oxford-iiit-pet
-------------------------------------
Started subject-driven fine tunning for breed Abyssinian...

Executing subject-driven technique...

Elapsed time: 368.2948224544525 seconds

-------------------------------------
Started subject-driven fine tunning for breed american_bulldog...

Executing subject-driven technique...

Elapsed time: 237.68498301506042 seconds

-------------------------------------
Started subject-driven fine tunning for breed american_pit_bull_terrier...

Executing subject-driven technique...

Elapsed time: 235.48205614089966 seconds

-------------------------------------
Started subject-driven fine tunning for breed basset_hound...

Executing subject-driven technique...

Elapsed time: 231.44669604301453 seconds

-------------------------------------
Started subject-driven fine tunning for breed beagle...

Executing subject-driven technique...

Elapsed time: 237.55933094024658 seconds

-------------------------------------
Started subject-driven fine tunning for breed Bengal...

Executing subject-driven technique...

Elapsed time: 237.74535059928894 seconds

-------------------------------------
Started subject-driven fine tunning for breed Birman...

Executing subject-driven technique...

Elapsed time: 234.3334379196167 seconds

-------------------------------------
Started subject-driven fine tunning for breed Bombay...

Executing subject-driven technique...

Elapsed time: 232.19179940223694 seconds

-------------------------------------
Started subject-driven fine tunning for breed boxer...

Executing subject-driven technique...

Elapsed time: 233.7994909286499 seconds

-------------------------------------
Started subject-driven fine tunning for breed British_Shorthair...

Executing subject-driven technique...

Elapsed time: 233.65171217918396 seconds

-------------------------------------
Started subject-driven fine tunning for breed chihuahua...

Executing subject-driven technique...

Elapsed time: 235.39813876152039 seconds

-------------------------------------
Started subject-driven fine tunning for breed Egyptian_Mau...

Executing subject-driven technique...

Elapsed time: 235.45848560333252 seconds

-------------------------------------
Started subject-driven fine tunning for breed english_cocker_spaniel...

Executing subject-driven technique...

Elapsed time: 233.6045582294464 seconds

-------------------------------------
Started subject-driven fine tunning for breed english_setter...

Executing subject-driven technique...

Elapsed time: 232.97492384910583 seconds

-------------------------------------
Started subject-driven fine tunning for breed german_shorthaired...

Executing subject-driven technique...

Elapsed time: 233.76652812957764 seconds

-------------------------------------
Started subject-driven fine tunning for breed great_pyrenees...

Executing subject-driven technique...

Elapsed time: 234.19633173942566 seconds

-------------------------------------
Started subject-driven fine tunning for breed havanese...

Executing subject-driven technique...

Elapsed time: 236.17606043815613 seconds

-------------------------------------
Started subject-driven fine tunning for breed japanese_chin...

Executing subject-driven technique...

Elapsed time: 233.62225675582886 seconds

-------------------------------------
Started subject-driven fine tunning for breed keeshond...

Executing subject-driven technique...

Elapsed time: 234.48011541366577 seconds

-------------------------------------
Started subject-driven fine tunning for breed leonberger...

Executing subject-driven technique...

Elapsed time: 237.85238027572632 seconds

-------------------------------------
Started subject-driven fine tunning for breed Maine_Coon...

Executing subject-driven technique...

Elapsed time: 232.48944759368896 seconds

-------------------------------------
Started subject-driven fine tunning for breed miniature_pinscher...

Executing subject-driven technique...

Elapsed time: 232.2889049053192 seconds

-------------------------------------
Started subject-driven fine tunning for breed newfoundland...

Executing subject-driven technique...

Elapsed time: 234.09246850013733 seconds

-------------------------------------
Started subject-driven fine tunning for breed Persian...

Executing subject-driven technique...

Elapsed time: 237.7181258201599 seconds

-------------------------------------
Started subject-driven fine tunning for breed pomeranian...

Executing subject-driven technique...

Elapsed time: 237.9170277118683 seconds

-------------------------------------
Started subject-driven fine tunning for breed pug...

Executing subject-driven technique...

Elapsed time: 233.69663763046265 seconds

-------------------------------------
Started subject-driven fine tunning for breed Ragdoll...

Executing subject-driven technique...

Elapsed time: 233.6922743320465 seconds

-------------------------------------
Started subject-driven fine tunning for breed Russian_Blue...

Executing subject-driven technique...

Elapsed time: 234.763085603714 seconds

-------------------------------------
Started subject-driven fine tunning for breed saint_bernard...

Executing subject-driven technique...

Elapsed time: 237.53822231292725 seconds

-------------------------------------
Started subject-driven fine tunning for breed samoyed...

Executing subject-driven technique...

Elapsed time: 235.67974638938904 seconds

-------------------------------------
Started subject-driven fine tunning for breed scottish_terrier...

Executing subject-driven technique...

Elapsed time: 233.52911710739136 seconds

-------------------------------------
Started subject-driven fine tunning for breed shiba_inu...

Executing subject-driven technique...

Elapsed time: 235.16295528411865 seconds

-------------------------------------
Started subject-driven fine tunning for breed Siamese...

Executing subject-driven technique...

Elapsed time: 234.49487853050232 seconds

-------------------------------------
Started subject-driven fine tunning for breed Sphynx...

Executing subject-driven technique...

Elapsed time: 236.98554229736328 seconds

-------------------------------------
Started subject-driven fine tunning for breed staffordshire_bull_terrier...

Executing subject-driven technique...

Elapsed time: 235.91469764709473 seconds

-------------------------------------
Started subject-driven fine tunning for breed wheaten_terrier...

Executing subject-driven technique...

Elapsed time: 236.51469254493713 seconds

-------------------------------------
Started subject-driven fine tunning for breed yorkshire_terrier...

Executing subject-driven technique...

Elapsed time: 234.7815294265747 seconds

-------------------------------------
Generating 20 images for breed Abyssinian...

Elapsed time: 66.9220986366272 seconds

-------------------------------------
Generating 20 images for breed american_bulldog...

Elapsed time: 62.052610874176025 seconds

-------------------------------------
Generating 20 images for breed american_pit_bull_terrier...

Elapsed time: 61.055460691452026 seconds

-------------------------------------
Generating 20 images for breed basset_hound...

Elapsed time: 64.90541338920593 seconds

-------------------------------------
Generating 20 images for breed beagle...

Elapsed time: 60.018755197525024 seconds

-------------------------------------
Generating 20 images for breed Bengal...

Elapsed time: 64.2443962097168 seconds

-------------------------------------
Generating 20 images for breed Birman...

Elapsed time: 62.26427960395813 seconds

-------------------------------------
Generating 20 images for breed Bombay...

Elapsed time: 62.95482420921326 seconds

-------------------------------------
Generating 20 images for breed boxer...

Elapsed time: 61.70529246330261 seconds

-------------------------------------
Generating 20 images for breed British_Shorthair...

Elapsed time: 63.16079616546631 seconds

-------------------------------------
Generating 20 images for breed chihuahua...

Elapsed time: 67.13433718681335 seconds

-------------------------------------
Generating 20 images for breed Egyptian_Mau...

Elapsed time: 64.12876558303833 seconds

-------------------------------------
Generating 20 images for breed english_cocker_spaniel...

Elapsed time: 62.464019536972046 seconds

-------------------------------------
Generating 20 images for breed english_setter...

Elapsed time: 61.1726336479187 seconds

-------------------------------------
Generating 20 images for breed german_shorthaired...

Elapsed time: 62.41411375999451 seconds

-------------------------------------
Generating 20 images for breed great_pyrenees...

Elapsed time: 61.92262268066406 seconds

-------------------------------------
Generating 20 images for breed havanese...

Elapsed time: 62.15493106842041 seconds

-------------------------------------
Generating 20 images for breed japanese_chin...

Elapsed time: 60.301056146621704 seconds

-------------------------------------
Generating 20 images for breed keeshond...

Elapsed time: 62.18414926528931 seconds

-------------------------------------
Generating 20 images for breed leonberger...

Elapsed time: 60.931556701660156 seconds

-------------------------------------
Generating 20 images for breed Maine_Coon...

Elapsed time: 61.253748655319214 seconds

-------------------------------------
Generating 20 images for breed miniature_pinscher...

Elapsed time: 59.90729331970215 seconds

-------------------------------------
Generating 20 images for breed newfoundland...

Elapsed time: 63.448243618011475 seconds

-------------------------------------
Generating 20 images for breed Persian...

Elapsed time: 61.06501126289368 seconds

-------------------------------------
Generating 20 images for breed pomeranian...

Elapsed time: 62.732430934906006 seconds

-------------------------------------
Generating 20 images for breed pug...

Elapsed time: 61.83364963531494 seconds

-------------------------------------
Generating 20 images for breed Ragdoll...

Elapsed time: 63.5906662940979 seconds

-------------------------------------
Generating 20 images for breed Russian_Blue...

Elapsed time: 63.78215193748474 seconds

-------------------------------------
Generating 20 images for breed saint_bernard...

Elapsed time: 62.040592670440674 seconds

-------------------------------------
Generating 20 images for breed samoyed...

Elapsed time: 64.64728021621704 seconds

-------------------------------------
Generating 20 images for breed scottish_terrier...

Elapsed time: 62.871294260025024 seconds

-------------------------------------
Generating 20 images for breed shiba_inu...

Elapsed time: 64.58580780029297 seconds

-------------------------------------
Generating 20 images for breed Siamese...

Elapsed time: 64.29071474075317 seconds

-------------------------------------
Generating 20 images for breed Sphynx...

Elapsed time: 66.86587595939636 seconds

-------------------------------------
Generating 20 images for breed staffordshire_bull_terrier...

Elapsed time: 65.50937795639038 seconds

-------------------------------------
Generating 20 images for breed wheaten_terrier...

Elapsed time: 63.5576057434082 seconds

-------------------------------------
Generating 20 images for breed yorkshire_terrier...

Elapsed time: 64.66650724411011 seconds

-------------------------------------
Generating 50 images for breed Abyssinian...

Elapsed time: 176.23715138435364 seconds

-------------------------------------
Generating 50 images for breed american_bulldog...

Elapsed time: 149.50882720947266 seconds

-------------------------------------
Generating 50 images for breed american_pit_bull_terrier...

Elapsed time: 145.97303128242493 seconds

-------------------------------------
Generating 50 images for breed basset_hound...

Elapsed time: 145.93621063232422 seconds

-------------------------------------
Generating 50 images for breed beagle...

Elapsed time: 146.67263841629028 seconds

-------------------------------------
Generating 50 images for breed Bengal...

Elapsed time: 148.73300433158875 seconds

-------------------------------------
Generating 50 images for breed Birman...

Elapsed time: 146.97408652305603 seconds

-------------------------------------
Generating 50 images for breed Bombay...

Elapsed time: 146.9249405860901 seconds

-------------------------------------
Generating 50 images for breed boxer...

Elapsed time: 146.24941158294678 seconds

-------------------------------------
Generating 50 images for breed British_Shorthair...

Elapsed time: 145.43291425704956 seconds

-------------------------------------
Generating 50 images for breed chihuahua...

Elapsed time: 147.3202977180481 seconds

-------------------------------------
Generating 50 images for breed Egyptian_Mau...

Elapsed time: 146.62127017974854 seconds

-------------------------------------
Generating 50 images for breed english_cocker_spaniel...

Elapsed time: 145.43843245506287 seconds

-------------------------------------
Generating 50 images for breed english_setter...

Elapsed time: 145.86910772323608 seconds

-------------------------------------
Generating 50 images for breed german_shorthaired...

Elapsed time: 146.64549016952515 seconds

-------------------------------------
Generating 50 images for breed great_pyrenees...

Elapsed time: 146.30594420433044 seconds

-------------------------------------
Generating 50 images for breed havanese...

Elapsed time: 147.08594036102295 seconds

-------------------------------------
Generating 50 images for breed japanese_chin...

Elapsed time: 148.30902695655823 seconds

-------------------------------------
Generating 50 images for breed keeshond...

Elapsed time: 147.12010216712952 seconds

-------------------------------------
Generating 50 images for breed leonberger...

Elapsed time: 147.38547563552856 seconds

-------------------------------------
Generating 50 images for breed Maine_Coon...

Elapsed time: 145.64915132522583 seconds

-------------------------------------
Generating 50 images for breed miniature_pinscher...

Elapsed time: 146.61583185195923 seconds

-------------------------------------
Generating 50 images for breed newfoundland...

Elapsed time: 146.89851689338684 seconds

-------------------------------------
Generating 50 images for breed Persian...

Elapsed time: 146.5943820476532 seconds

-------------------------------------
Generating 50 images for breed pomeranian...

Elapsed time: 146.5375258922577 seconds

-------------------------------------
Generating 50 images for breed pug...

Elapsed time: 145.37821054458618 seconds

-------------------------------------
Generating 50 images for breed Ragdoll...

Elapsed time: 144.5285575389862 seconds

-------------------------------------
Generating 50 images for breed Russian_Blue...

Elapsed time: 145.63150119781494 seconds

-------------------------------------
Generating 50 images for breed saint_bernard...

Elapsed time: 147.9604458808899 seconds

-------------------------------------
Generating 50 images for breed samoyed...

Elapsed time: 146.85432624816895 seconds

-------------------------------------
Generating 50 images for breed scottish_terrier...

Elapsed time: 145.11689448356628 seconds

-------------------------------------
Generating 50 images for breed shiba_inu...

Elapsed time: 145.41118836402893 seconds

-------------------------------------
Generating 50 images for breed Siamese...

Elapsed time: 146.44510555267334 seconds

-------------------------------------
Generating 50 images for breed Sphynx...

Elapsed time: 142.91667699813843 seconds

-------------------------------------
Generating 50 images for breed staffordshire_bull_terrier...

Elapsed time: 144.84157729148865 seconds

-------------------------------------
Generating 50 images for breed wheaten_terrier...

Elapsed time: 145.50413727760315 seconds

-------------------------------------
Generating 50 images for breed yorkshire_terrier...

Elapsed time: 145.6384060382843 seconds

Using cuda device
Epoch 1
-------------------------------
Training loss: 3.877454  [16/5406]
Training loss: 3.488527  [1616/5406]
Training loss: 3.270341  [3216/5406]
Training loss: 3.333472  [4816/5406]
Training accuracy: 27.64 %
Validation loss: 3.020080
Validation accuracy: 26.64% 

Epoch 2
-------------------------------
Training loss: 2.994744  [16/5406]
Training loss: 2.940675  [1616/5406]
Training loss: 2.763036  [3216/5406]
Training loss: 2.735301  [4816/5406]
Training accuracy: 53.94 %
Validation loss: 2.386854
Validation accuracy: 56.77% 

Epoch 3
-------------------------------
Training loss: 2.346157  [16/5406]
Training loss: 1.984851  [1616/5406]
Training loss: 2.438194  [3216/5406]
Training loss: 2.232596  [4816/5406]
Training accuracy: 65.72 %
Validation loss: 1.929310
Validation accuracy: 67.36% 

Epoch 4
-------------------------------
Training loss: 2.129215  [16/5406]
Training loss: 1.851315  [1616/5406]
Training loss: 2.092274  [3216/5406]
Training loss: 1.851323  [4816/5406]
Training accuracy: 71.40 %
Validation loss: 1.600479
Validation accuracy: 73.80% 

Epoch 5
-------------------------------
Training loss: 1.526343  [16/5406]
Training loss: 1.820388  [1616/5406]
Training loss: 1.898973  [3216/5406]
Training loss: 1.363178  [4816/5406]
Training accuracy: 74.34 %
Validation loss: 1.345248
Validation accuracy: 77.57% 

Epoch 6
-------------------------------
Training loss: 2.047281  [16/5406]
Training loss: 1.630334  [1616/5406]
Training loss: 1.367700  [3216/5406]
Training loss: 1.743105  [4816/5406]
Training accuracy: 76.53 %
Validation loss: 1.181401
Validation accuracy: 79.42% 

Epoch 7
-------------------------------
Training loss: 1.190012  [16/5406]
Training loss: 0.827700  [1616/5406]
Training loss: 1.138959  [3216/5406]
Training loss: 0.849146  [4816/5406]
Training accuracy: 78.62 %
Validation loss: 1.046982
Validation accuracy: 80.62% 

Epoch 8
-------------------------------
Training loss: 1.171740  [16/5406]
Training loss: 1.147050  [1616/5406]
Training loss: 0.842636  [3216/5406]
Training loss: 1.153361  [4816/5406]
Training accuracy: 80.15 %
Validation loss: 0.971878
Validation accuracy: 82.04% 

Epoch 9
-------------------------------
Training loss: 0.986704  [16/5406]
Training loss: 1.061184  [1616/5406]
Training loss: 1.036579  [3216/5406]
Training loss: 1.590463  [4816/5406]
Training accuracy: 80.47 %
Validation loss: 0.898820
Validation accuracy: 81.71% 

Epoch 10
-------------------------------
Training loss: 0.892195  [16/5406]
Training loss: 0.843983  [1616/5406]
Training loss: 0.859613  [3216/5406]
Training loss: 0.818443  [4816/5406]
Training accuracy: 81.34 %
Validation loss: 0.828097
Validation accuracy: 82.91% 

Epoch 11
-------------------------------
Training loss: 0.812243  [16/5406]
Training loss: 0.684898  [1616/5406]
Training loss: 0.775205  [3216/5406]
Training loss: 0.791378  [4816/5406]
Training accuracy: 81.63 %
Validation loss: 0.786702
Validation accuracy: 83.19% 

Epoch 12
-------------------------------
Training loss: 1.309217  [16/5406]
Training loss: 1.137673  [1616/5406]
Training loss: 0.700576  [3216/5406]
Training loss: 0.679509  [4816/5406]
Training accuracy: 82.24 %
Validation loss: 0.736909
Validation accuracy: 84.28% 

Epoch 13
-------------------------------
Training loss: 0.730291  [16/5406]
Training loss: 0.947598  [1616/5406]
Training loss: 0.930124  [3216/5406]
Training loss: 0.906563  [4816/5406]
Training accuracy: 83.44 %
Validation loss: 0.709636
Validation accuracy: 84.83% 

Epoch 14
-------------------------------
Training loss: 1.017022  [16/5406]
Training loss: 0.519341  [1616/5406]
Training loss: 1.229299  [3216/5406]
Training loss: 0.829874  [4816/5406]
Training accuracy: 83.91 %
Validation loss: 0.680914
Validation accuracy: 84.33% 

Epoch 15
-------------------------------
Training loss: 0.775551  [16/5406]
Training loss: 0.578028  [1616/5406]
Training loss: 0.755658  [3216/5406]
Training loss: 0.784782  [4816/5406]
Training accuracy: 84.07 %
Validation loss: 0.661238
Validation accuracy: 84.12% 

Epoch 16
-------------------------------
Training loss: 0.998178  [16/5406]
Training loss: 0.978228  [1616/5406]
Training loss: 0.773805  [3216/5406]
Training loss: 1.193573  [4816/5406]
Training accuracy: 83.50 %
Validation loss: 0.646171
Validation accuracy: 84.93% 

Epoch 17
-------------------------------
Training loss: 0.650458  [16/5406]
Training loss: 0.674185  [1616/5406]
Training loss: 0.881115  [3216/5406]
Training loss: 1.067663  [4816/5406]
Training accuracy: 84.63 %
Validation loss: 0.620625
Validation accuracy: 85.15% 

Epoch 18
-------------------------------
Training loss: 0.548196  [16/5406]
Training loss: 0.703008  [1616/5406]
Training loss: 0.981109  [3216/5406]
Training loss: 0.985813  [4816/5406]
Training accuracy: 84.70 %
Validation loss: 0.604623
Validation accuracy: 85.21% 

Epoch 19
-------------------------------
Training loss: 0.742132  [16/5406]
Training loss: 0.734407  [1616/5406]
Training loss: 0.776771  [3216/5406]
Training loss: 0.770120  [4816/5406]
Training accuracy: 85.09 %
Validation loss: 0.583115
Validation accuracy: 85.70% 

Epoch 20
-------------------------------
Training loss: 0.715483  [16/5406]
Training loss: 0.884903  [1616/5406]
Training loss: 0.698206  [3216/5406]
Training loss: 0.651203  [4816/5406]
Training accuracy: 85.29 %
Validation loss: 0.568716
Validation accuracy: 85.70% 

Epoch 21
-------------------------------
Training loss: 0.856471  [16/5406]
Training loss: 0.944518  [1616/5406]
Training loss: 0.433833  [3216/5406]
Training loss: 0.515486  [4816/5406]
Training accuracy: 85.61 %
Validation loss: 0.559848
Validation accuracy: 85.64% 

Epoch 22
-------------------------------
Training loss: 0.703657  [16/5406]
Training loss: 0.400318  [1616/5406]
Training loss: 1.076612  [3216/5406]
Training loss: 0.595403  [4816/5406]
Training accuracy: 85.31 %
Validation loss: 0.546121
Validation accuracy: 85.70% 

Epoch 23
-------------------------------
Training loss: 0.569637  [16/5406]
Training loss: 0.506999  [1616/5406]
Training loss: 0.568498  [3216/5406]
Training loss: 0.799869  [4816/5406]
Training accuracy: 85.31 %
Validation loss: 0.553411
Validation accuracy: 85.53% 

Epoch 24
-------------------------------
Training loss: 0.601882  [16/5406]
Training loss: 0.475498  [1616/5406]
Training loss: 1.250340  [3216/5406]
Training loss: 0.452646  [4816/5406]
Training accuracy: 86.00 %
Validation loss: 0.541905
Validation accuracy: 85.59% 

Early stopping
Done!

Elapsed time: 2155.0873193740845 seconds

                         precision    recall  f1-score   support

             Abyssinian       0.91      0.59      0.72        49
       American Bulldog       0.77      0.94      0.85        50
  American pitbull terr       0.79      0.60      0.68        50
           Basset hound       0.89      0.96      0.92        50
                 Beagle       0.95      0.84      0.89        50
                 Bengal       0.70      0.74      0.72        50
                 Birman       0.80      0.78      0.79        50
                 Bombay       0.75      0.91      0.82        44
                  Boxer       0.80      0.90      0.85        50
      British Shorthair       0.80      0.80      0.80        50
              Chihuahua       0.85      0.78      0.81        50
           Egyptian Mau       0.89      0.84      0.86        49
 English cocker spaniel       0.96      0.92      0.94        50
         English setter       0.92      0.90      0.91        50
     German shorthaired       0.82      1.00      0.90        50
         Great pyrenees       0.92      0.98      0.95        50
               Havanese       0.84      0.98      0.91        50
          Japanese chin       0.98      0.94      0.96        50
               Keeshond       0.94      1.00      0.97        50
             Leonberger       1.00      0.98      0.99        50
             Maine Coon       0.81      0.68      0.74        50
     Miniature pinscher       0.94      0.88      0.91        50
           Newfoundland       0.94      1.00      0.97        50
                Persian       0.80      0.82      0.81        50
             Pomeranian       1.00      0.78      0.88        50
                    Pug       1.00      0.88      0.94        50
                Ragdoll       0.80      0.72      0.76        50
           Russian blue       0.75      0.72      0.73        50
          Saint bernard       0.91      0.98      0.94        50
                Samoyed       0.81      1.00      0.89        50
       Scottish terrier       0.85      1.00      0.92        50
              Shiba inu       0.92      0.96      0.94        50
                Siamese       0.86      0.88      0.87        50
                 Sphynx       0.79      0.84      0.82        50
Staffordshire bull terr       0.66      0.73      0.69        45
        Wheaten terrier       1.00      0.88      0.94        50
      Yorkshire terrier       0.95      0.80      0.87        50

               accuracy                           0.86      1837
              macro avg       0.87      0.86      0.86      1837
           weighted avg       0.87      0.86      0.86      1837

Test accuracy: 0.8633641807294502
